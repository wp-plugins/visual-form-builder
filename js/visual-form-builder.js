jQuery(document).ready(function(f){f(document).on("click","a.addOption",function(v){v.preventDefault();var q=f(this).parent().parent().find(".clonedOption").length;var u=q+1;var w=f(this).closest("div").attr("id");var t=f(this).closest("div").children("label").attr("for");var p=t.replace(new RegExp(/(\d+)$/g),"");var s=w.replace(new RegExp(/(\d+)$/g),"");var r=f("#"+w).clone().attr("id",s+u);r.children("label").attr("for",p+u);r.find("input").attr("id",p+u);f("#"+s+q).after(r)});f(document).on("click","a.deleteOption",function(q){q.preventDefault();var p=f(this).parent().parent().find(".clonedOption").length;if(p-1==0){alert("You must have at least one option.")}else{f(this).closest("div").remove()}});f(document).on("click","a.addEmail",function(v){v.preventDefault();var q=f(this).parent().parent().find(".clonedOption").length;var u=q+1;var w=f(this).closest("div").attr("id");var t=f(this).closest("div").children("label").attr("for");var p=t.replace(new RegExp(/(\d+)$/g),"");var s=w.replace(new RegExp(/(\d+)$/g),"");var r=f("#"+w).clone().attr("id",s+u);r.children("label").attr("for",p+u);r.find("input").attr("id",p+u);f("#"+s+q).after(r)});f(document).on("click","a.deleteEmail",function(q){q.preventDefault();var p=f(this).parent().parent().find(".clonedOption").length;if(p-1==0){alert("You must have at least one option.")}else{f(this).closest("div").remove()}});f(".menu-delete, .entry-delete").click(function(q){q.preventDefault();var p=(f(this).hasClass("entry-delete"))?"entry":"form";var r=confirm("You are about to permanently delete this "+p+" and all of its data.\n'Cancel' to stop, 'OK' to delete.");if(r){return}});f(document).on("click","a.item-edit",function(p){p.preventDefault();f(p.target).closest("li").children(".menu-item-settings").slideToggle("fast");f(this).toggleClass("opened")});f("#form-copy-to-clipboard").focus(function(){this.select()});var e=f(".nav-tabs-wrapper"),i=e.children(".nav-tabs"),d=i.children(".nav-tab-active"),k=i.children(".nav-tab"),b=0,m,c,h={},j,a="margin-left",o="margin-right",l=2;k.each(function(){b+=f(this).outerWidth(true)});h.padding=0;h[o]=(-1*b)+"px";i.css(h);g();function g(){if(e.length){var r=e.width(),q=0,p={};c=e.offset().left;m=c+r;d.makeTabVisible(c,m,i,a,l);if(k.last().isTabVisible(c,m)){q=e.width()-b;q=q>0?0:q;p[a]=q+"px";i.animate(p,100,"linear")}if(r>b){f(".nav-tabs-arrow-right, .nav-tabs-arrow-left").hide()}else{f(".nav-tabs-arrow-right, .nav-tabs-arrow-left").show()}}}f(window).resize(function(){if(j){clearTimeout(j)}j=setTimeout(g,200)});f(".nav-tabs-arrow-right").mousedown(function(){var r=Math.abs(parseInt(i.css(a))),p=r,q={};p=Math.abs(b-e.width())-r;if(!p){return}q[a]="-="+p+"px";i.animate(q,p*l,"linear")}).mouseup(function(){i.stop(true)});f(".nav-tabs-arrow-left").mousedown(function(){var r=Math.abs(parseInt(i.css(a))),p=r,q={};if(!p){return}q[a]="+="+p+"px";i.animate(q,p*l,"linear")}).mouseup(function(){i.stop(true)});f("#menu-to-edit").nestedSortable({listType:"ul",maxLevels:3,handle:".menu-item-handle",placeholder:"sortable-placeholder",tolerance:"pointer",toleranceElement:"> dl",items:"li:not(.ui-state-disabled)",create:function(p,q){f(this).css("min-height",f(this).height())},start:function(p,q){q.placeholder.height(q.item.height())},stop:function(p,q){opts={url:ajaxurl,type:"POST",async:true,cache:false,dataType:"json",data:{action:"visual_form_builder_process_sort",order:f(this).nestedSortable("toArray")},success:function(r){f("#loading-animation").hide();return}};f.ajax(opts)}});f('#form-items input[type="submit"]').click(function(){f(this).closest("form").data("submit_value",f(this))});f(document).on("submit","#form-items",function(q){q.preventDefault();var r=f(this).serializeArray(),p=f(this).data("submit_value").attr("value");f("img.waiting").show();f.ajax({url:ajaxurl,type:"POST",async:true,cache:false,dataType:"html",data:{action:"visual_form_builder_create_field",data:r,field_type:p,page:pagenow,nonce:f("#_wpnonce").val()},success:function(s){f("img.waiting").hide();f(s).hide().insertBefore("#menu-to-edit li.ui-state-disabled:first").fadeIn();return},error:function(t,u,s){alert(t+" "+u+" "+s);return}})});f(document).on("click","a.item-delete",function(w){w.preventDefault();var u=childs=new Array(),A=0,q=f(this).attr("href"),p=q.split("&");for(var v=0;v<p.length;v++){var y=p[v].indexOf("=");var x=p[v].substring(0,y);var z=p[v].substring(y+1);u[x]=z}var r=f(this).closest(".form-item").find("ul").children();var s=r.parent().html();r.each(function(t){childs[t]=f(this).attr("id").match(new RegExp(/(\d+)$/g))[0]});var B=f(this).closest("li.form-item").parents("li.form-item");if(B.length){A=B.attr("id").match(new RegExp(/(\d+)$/g))[0]}f.ajax({url:ajaxurl,type:"POST",async:true,cache:false,dataType:"html",data:{action:"visual_form_builder_delete_field",form:u.form,field:u.field,child_ids:childs,parent_id:A,page:pagenow,nonce:u._wpnonce},success:function(t){f("#form_item_"+u.field).addClass("deleting").animate({opacity:0,height:0},350,function(){f(this).before(s).remove()});return},error:function(C,D,t){alert("There was an error loading the content");return}})});var n=f(".form-success-type:checked").val();f("#form-success-message-"+n).show();f(".form-success-type").change(function(){var p=f(this).val();if("text"==p){f("#form-success-message-text").show();f("#form-success-message-page, #form-success-message-redirect").hide()}else{if("page"==p){f("#form-success-message-page").show();f("#form-success-message-text, #form-success-message-redirect").hide()}else{if("redirect"==p){f("#form-success-message-redirect").show();f("#form-success-message-text, #form-success-message-page").hide()}}}});f(".vfb-field-types").click(function(q){q.preventDefault();f("#vfb-field-tabs li").removeClass("tabs");f(this).parent().addClass("tabs");f(".tabs-panel-active").removeClass("tabs-panel-active").addClass("tabs-panel-inactive");var p=this.hash;f(p).removeClass("tabs-panel-inactive").addClass("tabs-panel-active")});f("#visual-form-builder-update").validate({rules:{"form_email_to[]":{email:true},form_email_from:{email:true},form_success_message_redirect:{url:true},form_notification_email_name:{required:function(p){return f("#form-notification-setting").is(":checked")}},form_notification_email_from:{required:function(p){return f("#form-notification-setting").is(":checked")},email:true},form_notification_email:{required:function(p){return f("#form-notification-setting").is(":checked")}}},errorPlacement:function(p,q){p.insertAfter(q.parent())}});f("#form_email_from_name_override").change(function(){if(f("#form_email_from_name_override").val()==""){f("#form-email-sender-name").attr("readonly",false)}else{f("#form-email-sender-name").attr("readonly","readonly")}});f("#form_email_from_override").change(function(){if(f("#form_email_from_override").val()==""){f("#form-email-sender").attr("readonly",false)}else{f("#form-email-sender").attr("readonly","readonly")}});if(f("#form-notification-setting").is(":checked")){f("#notification-email").show()}else{f("#notification-email").hide()}f("#form-notification-setting").change(function(){var p=f(this).is(":checked");if(p){f("#notification-email").show();f("#form-notification-email-name, #form-notification-email-from, #form-notification-email, #form-notification-subject, #form-notification-message, #form-notification-entry").attr("disabled",false)}else{f("#notification-email").hide();f("#form-notification-email-name, #form-notification-email-from, #form-notification-email, #form-notification-subject, #form-notification-message, #form-notification-entry").attr("disabled","disabled")}});f.validator.addMethod("multiemail",function(r,q){if(this.optional(q)){return true}var s=r.split(new RegExp("\\s*[,|;]\\s*","gi"));valid=true;for(var p in s){r=s[p];valid=valid&&jQuery.validator.methods.email.call(this,r,q)}return valid},"One or more email addresses are invalid")});jQuery.fn.extend({makeTabVisible:function(d,h,f,b,g){var j=this.eq(0),c,i,e={},a=0;if(!j.length){return this}c=j.offset().left;i=c+j.outerWidth();if(i>h){a=h-i}else{if(c<d){a=d-c}}if(!a){return this}e[b]="+="+1*a+"px";f.animate(e,Math.abs(a)*g,"linear");return this},isTabVisible:function(e,d){var b=this.eq(0),c=b.offset().left,a=c+b.outerWidth();return(a<=d&&c>=e)?true:false}});